# README

## Описание файлов

* **main.py** — основной скрипт для обучения на парах Intension vs Antonym.

  * Загружает и предобрабатывает данные из `correct_data.xlsx` и `correct_ant.xlsx`.
  * Обучает модель для каждой пары (интенсия и антоним).
  * Сохраняет лучшие веса модели каждой пары в файлы `best_<Intent>.pt`.
  * По завершении выводит и сохраняет финальные значения валидационной точности для каждой пары в `validation_accuracy_summary.csv`.

* **inference.py** — скрипт для инференса (оценки произвольного предложения на предрасположенность к каждой интенсии).

  * Конфигурируется внутри: задаётся фраза `TEXT` и директория `MODEL_DIR`, где лежат сохранённые модели `best_<Intent>.pt`.
  * Для каждой сохранённой модели вычисляет вероятность и выводит отсортированный по убыванию список пар (интенсия, вероятность).

## Параметры обучения (`main.py`)

В начале `main.py` задаются константы:

* `EPOCHS` — число эпох обучения (по умолчанию 7).
* `BATCH_SIZE` — размер батча для DataLoader (по умолчанию 16).
* `LR` — начальный learning rate для оптимизатора AdamW (по умолчанию 1e-5).
* `SEED` — фиксированное значение random seed для воспроизводимости (по умолчанию 42).
* `PATIENCE` — число эпох без улучшения валидационного accuracy перед ранней остановкой (по умолчанию 2).

## Параметры инференса (`inference.py`)

В начале `inference.py` указываются:

* `TEXT` — проверяемая фраза.
* `MODEL_DIR` — папка, содержащая все файлы `best_<Intent>.pt`.

## Последовательность запуска

1. Убедитесь, что в каталоге присутствуют файлы данных:

   * `correct_data.xlsx`
   * `correct_ant.xlsx`

2. Запустите обучение:

   ```bash
   python main.py
   ```

   Результатом будут:

   * Файлы `best_<Intent>.pt` для каждой обученной пары.
   * `validation_accuracy_summary.csv` с валид. точностью по парам.

3. Настройте `inference.py`:

   * Вставьте нужную фразу в `TEXT`.
   * Проверьте `MODEL_DIR` (путь к папке с моделями).

4. Запустите инференс:

   ```bash
   python inference.py
   ```

   В консоли вы увидите:

   * Входную фразу.
   * Список интенсий с вероятностями, отсортированный по убыванию.
